/*
 * jScrollPane - v2.0.0beta11 - 2011-07-04
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(B,A,C){B.fn.jScrollPane=function(E){function D(c,n){var AY,p=this,y,AK,U,AM,t,z,X,Q,AZ,Ae,AU,I,h,H,J,AA,u,AQ,x,S,Z,AR,AF,AN,f,L,AT,AX,W,AV,Ah,F,k,AJ=true,o=true,Ag=false,K=false,AP=c.clone(false,false).empty(),AC=B.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";Ah=c.css("paddingTop")+" "+c.css("paddingRight")+" "+c.css("paddingBottom")+" "+c.css("paddingLeft");F=(parseInt(c.css("paddingLeft"),10)||0)+(parseInt(c.css("paddingRight"),10)||0);function AS(Aq){var Al,An,Am,Aj,Ai,Ap,Ao=false,Ak=false;AY=Aq;if(y===C){Ai=c.scrollTop();Ap=c.scrollLeft();c.css({overflow:"hidden",padding:0});AK=c.innerWidth()+F;U=c.innerHeight();c.width(AK);y=B('<div class="jspPane" />').css("padding",Ah).append(c.children());AM=B('<div class="jspContainer" />').css({width:"100%",height:U+"px"}).append(y).appendTo(c);}else{c.css("width","");Ao=AY.stickToBottom&&j();Ak=AY.stickToRight&&a();Aj=c.innerWidth()+F!=AK||c.outerHeight()!=U;if(Aj){AK=c.innerWidth()+F;U=c.innerHeight();AM.css({width:"100%",height:U+"px"});}if(!Aj&&k==t&&y.outerHeight()==z){c.width(AK);return ;}k=t;y.css("width","");c.width(AK);AM.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end();}y.css("overflow","auto");if(Aq.contentWidth){t=Aq.contentWidth;}else{t=y[0].scrollWidth;}z=y[0].scrollHeight;y.css("overflow","");X=t/AK;Q=z/U;AZ=Q>1;Ae=X>1;if(!(Ae||AZ)){c.removeClass("jspScrollable");y.css({top:0,width:AM.width()});N();d();q();V();AI();}else{c.addClass("jspScrollable");Al=AY.maintainPosition&&(h||AA);if(Al){An=Ac();Am=Aa();}Af();Y();e();if(Al){m(Ak?(t-AK):An,false);l(Ao?(z-U):Am,false);}i();AG();AO();if(AY.enableKeyboardNavigation){r();}if(AY.clickOnTrack){P();}b();if(AY.hijackInternalLinks){M();}}if(AY.autoReinitialise&&!AV){AV=setInterval(function(){AS(AY);},AY.autoReinitialiseDelay);}else{if(!AY.autoReinitialise&&AV){clearInterval(AV);}}Ai&&c.scrollTop(0)&&l(Ai,false);Ap&&c.scrollLeft(0)&&m(Ap,false);c.trigger("jsp-initialised",[Ae||AZ]);}function Af(){if(AZ){AM.append(B('<div class="jspVerticalBar" />').append(B('<div class="jspCap jspCapTop" />'),B('<div class="jspTrack" />').append(B('<div class="jspDrag" />').append(B('<div class="jspDragTop" />'),B('<div class="jspDragBottom" />'))),B('<div class="jspCap jspCapBottom" />')));u=AM.find(">.jspVerticalBar");AQ=u.find(">.jspTrack");AU=AQ.find(">.jspDrag");if(AY.showArrows){AR=B('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",Ad(0,-1)).bind("click.jsp",Ab);AF=B('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",Ad(0,1)).bind("click.jsp",Ab);if(AY.arrowScrollOnHover){AR.bind("mouseover.jsp",Ad(0,-1,AR));AF.bind("mouseover.jsp",Ad(0,1,AF));}AL(AQ,AY.verticalArrowPositions,AR,AF);}S=U;AM.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){S-=B(this).outerHeight();});AU.hover(function(){AU.addClass("jspHover");},function(){AU.removeClass("jspHover");}).bind("mousedown.jsp",function(Ai){B("html").bind("dragstart.jsp selectstart.jsp",Ab);AU.addClass("jspActive");var s=Ai.pageY-AU.position().top;B("html").bind("mousemove.jsp",function(Aj){v(Aj.pageY-s,false);}).bind("mouseup.jsp mouseleave.jsp",AW);return false;});O();}}function O(){AQ.height(S+"px");h=0;x=AY.verticalGutter+AQ.outerWidth();y.width(AK);try{if(u.position().left===0){y.css("margin-left",x+"px");}}catch(s){}}function Y(){if(Ae){AM.append(B('<div class="jspHorizontalBar" />').append(B('<div class="jspCap jspCapLeft" />'),B('<div class="jspTrack" />').append(B('<div class="jspDrag" />').append(B('<div class="jspDragLeft" />'),B('<div class="jspDragRight" />'))),B('<div class="jspCap jspCapRight" />')));AN=AM.find(">.jspHorizontalBar");f=AN.find(">.jspTrack");H=f.find(">.jspDrag");if(AY.showArrows){AX=B('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",Ad(-1,0)).bind("click.jsp",Ab);W=B('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",Ad(1,0)).bind("click.jsp",Ab);if(AY.arrowScrollOnHover){AX.bind("mouseover.jsp",Ad(-1,0,AX));W.bind("mouseover.jsp",Ad(1,0,W));}AL(f,AY.horizontalArrowPositions,AX,W);}H.hover(function(){H.addClass("jspHover");},function(){H.removeClass("jspHover");}).bind("mousedown.jsp",function(Ai){B("html").bind("dragstart.jsp selectstart.jsp",Ab);H.addClass("jspActive");var s=Ai.pageX-H.position().left;B("html").bind("mousemove.jsp",function(Aj){w(Aj.pageX-s,false);}).bind("mouseup.jsp mouseleave.jsp",AW);return false;});L=AM.innerWidth();AH();}}function AH(){AM.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){L-=B(this).outerWidth();});f.width(L+"px");AA=0;}function e(){if(Ae&&AZ){var Ai=f.outerHeight(),s=AQ.outerWidth();S-=Ai;B(AN).find(">.jspCap:visible,>.jspArrow").each(function(){L+=B(this).outerWidth();});L-=s;U-=s;AK-=Ai;f.parent().append(B('<div class="jspCorner" />').css("width",Ai+"px"));O();AH();}if(Ae){y.width((AM.outerWidth()-F)+"px");}z=y.outerHeight();Q=z/U;if(Ae){AT=Math.ceil(1/X*L);if(AT>AY.horizontalDragMaxWidth){AT=AY.horizontalDragMaxWidth;}else{if(AT<AY.horizontalDragMinWidth){AT=AY.horizontalDragMinWidth;}}H.width(AT+"px");J=L-AT;AE(AA);}if(AZ){Z=Math.ceil(1/Q*S);if(Z>AY.verticalDragMaxHeight){Z=AY.verticalDragMaxHeight;}else{if(Z<AY.verticalDragMinHeight){Z=AY.verticalDragMinHeight;}}AU.height(Z+"px");I=S-Z;AD(h);}}function AL(Aj,Al,Ai,s){var An="before",Ak="after",Am;if(Al=="os"){Al=/Mac/.test(navigator.platform)?"after":"split";}if(Al==An){Ak=Al;}else{if(Al==Ak){An=Al;Am=Ai;Ai=s;s=Am;}}Aj[An](Ai)[Ak](s);}function Ad(Ai,s,Aj){return function(){g(Ai,s,this,Aj);this.blur();return false;};}function g(Al,Ak,Ao,An){Ao=B(Ao).addClass("jspActive");var Am,Aj,Ai=true,s=function(){if(Al!==0){p.scrollByX(Al*AY.arrowButtonSpeed);}if(Ak!==0){p.scrollByY(Ak*AY.arrowButtonSpeed);}Aj=setTimeout(s,Ai?AY.initialDelay:AY.arrowRepeatFreq);Ai=false;};s();Am=An?"mouseout.jsp":"mouseup.jsp";An=An||B("html");An.bind(Am,function(){Ao.removeClass("jspActive");Aj&&clearTimeout(Aj);Aj=null;An.unbind(Am);});}function P(){V();if(AZ){AQ.bind("mousedown.jsp",function(An){if(An.originalTarget===C||An.originalTarget==An.currentTarget){var Al=B(this),Ao=Al.offset(),Am=An.pageY-Ao.top-h,Aj,Ai=true,s=function(){var Ar=Al.offset(),As=An.pageY-Ar.top-Z/2,Ap=U*AY.scrollPagePercent,Aq=I*Ap/(z-U);if(Am<0){if(h-Aq>As){p.scrollByY(-Ap);}else{v(As);}}else{if(Am>0){if(h+Aq<As){p.scrollByY(Ap);}else{v(As);}}else{Ak();return ;}}Aj=setTimeout(s,Ai?AY.initialDelay:AY.trackClickRepeatFreq);Ai=false;},Ak=function(){Aj&&clearTimeout(Aj);Aj=null;B(document).unbind("mouseup.jsp",Ak);};s();B(document).bind("mouseup.jsp",Ak);return false;}});}if(Ae){f.bind("mousedown.jsp",function(An){if(An.originalTarget===C||An.originalTarget==An.currentTarget){var Al=B(this),Ao=Al.offset(),Am=An.pageX-Ao.left-AA,Aj,Ai=true,s=function(){var Ar=Al.offset(),As=An.pageX-Ar.left-AT/2,Ap=AK*AY.scrollPagePercent,Aq=J*Ap/(t-AK);if(Am<0){if(AA-Aq>As){p.scrollByX(-Ap);}else{w(As);}}else{if(Am>0){if(AA+Aq<As){p.scrollByX(Ap);}else{w(As);}}else{Ak();return ;}}Aj=setTimeout(s,Ai?AY.initialDelay:AY.trackClickRepeatFreq);Ai=false;},Ak=function(){Aj&&clearTimeout(Aj);Aj=null;B(document).unbind("mouseup.jsp",Ak);};s();B(document).bind("mouseup.jsp",Ak);return false;}});}}function V(){if(f){f.unbind("mousedown.jsp");}if(AQ){AQ.unbind("mousedown.jsp");}}function AW(){B("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");if(AU){AU.removeClass("jspActive");}if(H){H.removeClass("jspActive");}}function v(s,Ai){if(!AZ){return ;}if(s<0){s=0;}else{if(s>I){s=I;}}if(Ai===C){Ai=AY.animateScroll;}if(Ai){p.animate(AU,"top",s,AD);}else{AU.css("top",s);AD(s);}}function AD(Ai){if(Ai===C){Ai=AU.position().top;}AM.scrollTop(0);h=Ai;var Al=h===0,Aj=h==I,Ak=Ai/I,s=-Ak*(z-U);if(AJ!=Al||Ag!=Aj){AJ=Al;Ag=Aj;c.trigger("jsp-arrow-change",[AJ,Ag,o,K]);}T(Al,Aj);y.css("top",s);c.trigger("jsp-scroll-y",[-s,Al,Aj]).trigger("scroll");}function w(Ai,s){if(!Ae){return ;}if(Ai<0){Ai=0;}else{if(Ai>J){Ai=J;}}if(s===C){s=AY.animateScroll;}if(s){p.animate(H,"left",Ai,AE);}else{H.css("left",Ai);AE(Ai);}}function AE(Ai){if(Ai===C){Ai=H.position().left;}AM.scrollTop(0);AA=Ai;var Al=AA===0,Ak=AA==J,Aj=Ai/J,s=-Aj*(t-AK);if(o!=Al||K!=Ak){o=Al;K=Ak;c.trigger("jsp-arrow-change",[AJ,Ag,o,K]);}R(Al,Ak);y.css("left",s);c.trigger("jsp-scroll-x",[-s,Al,Ak]).trigger("scroll");}function T(Ai,s){if(AY.showArrows){AR[Ai?"addClass":"removeClass"]("jspDisabled");AF[s?"addClass":"removeClass"]("jspDisabled");}}function R(Ai,s){if(AY.showArrows){AX[Ai?"addClass":"removeClass"]("jspDisabled");W[s?"addClass":"removeClass"]("jspDisabled");}}function l(s,Ai){var Aj=s/(z-U);v(Aj*I,Ai);}function m(Ai,s){var Aj=Ai/(t-AK);w(Aj*J,s);}function AB(Av,Aq,Aj){var An,Ak,Al,s=0,Au=0,Ai,Ap,Ao,As,Ar,At;try{An=B(Av);}catch(Am){return ;}Ak=An.outerHeight();Al=An.outerWidth();AM.scrollTop(0);AM.scrollLeft(0);while(!An.is(".jspPane")){s+=An.position().top;Au+=An.position().left;An=An.offsetParent();if(/^body|html$/i.test(An[0].nodeName)){return ;}}Ai=Aa();Ao=Ai+U;if(s<Ai||Aq){Ar=s-AY.verticalGutter;}else{if(s+Ak>Ao){Ar=s-U+Ak+AY.verticalGutter;}}if(Ar){l(Ar,Aj);}Ap=Ac();As=Ap+AK;if(Au<Ap||Aq){At=Au-AY.horizontalGutter;}else{if(Au+Al>As){At=Au-AK+Al+AY.horizontalGutter;}}if(At){m(At,Aj);}}function Ac(){return -y.position().left;}function Aa(){return -y.position().top;}function j(){var s=z-U;return(s>20)&&(s-Aa()<10);}function a(){var s=t-AK;return(s>20)&&(s-Ac()<10);}function AG(){AM.unbind(AC).bind(AC,function(Al,Am,Ak,Ai){var Aj=AA,s=h;p.scrollBy(Ak*AY.mouseWheelSpeed,-Ai*AY.mouseWheelSpeed,false);return Aj==AA&&s==h;});}function N(){AM.unbind(AC);}function Ab(){return false;}function i(){y.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(s){AB(s.target,false);});}function d(){y.find(":input,a").unbind("focus.jsp");}function r(){var s,Ai,Ak=[];Ae&&Ak.push(AN[0]);AZ&&Ak.push(u[0]);y.focus(function(){c.focus();});c.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(An){if(An.target!==this&&!(Ak.length&&B(An.target).closest(Ak).length)){return ;}var Am=AA,Al=h;switch(An.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:s=An.keyCode;Aj();break;case 35:l(z-U);s=null;break;case 36:l(0);s=null;break;}Ai=An.keyCode==s&&Am!=AA||Al!=h;return !Ai;}).bind("keypress.jsp",function(Al){if(Al.keyCode==s){Aj();}return !Ai;});if(AY.hideFocus){c.css("outline","none");if("hideFocus" in AM[0]){c.attr("hideFocus",true);}}else{c.css("outline","");if("hideFocus" in AM[0]){c.attr("hideFocus",false);}}function Aj(){var Am=AA,Al=h;switch(s){case 40:p.scrollByY(AY.keyboardSpeed,false);break;case 38:p.scrollByY(-AY.keyboardSpeed,false);break;case 34:case 32:p.scrollByY(U*AY.scrollPagePercent,false);break;case 33:p.scrollByY(-U*AY.scrollPagePercent,false);break;case 39:p.scrollByX(AY.keyboardSpeed,false);break;case 37:p.scrollByX(-AY.keyboardSpeed,false);break;}Ai=Am!=AA||Al!=h;return Ai;}}function q(){c.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp");}function b(){if(location.hash&&location.hash.length>1){var Ak,Ai,Aj=escape(location.hash);try{Ak=B(Aj);}catch(s){return ;}if(Ak.length&&y.find(Aj)){if(AM.scrollTop()===0){Ai=setInterval(function(){if(AM.scrollTop()>0){AB(Aj,true);B(document).scrollTop(AM.position().top);clearInterval(Ai);}},50);}else{AB(Aj,true);B(document).scrollTop(AM.position().top);}}}}function AI(){B("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack");}function M(){AI();B("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var s=this.href.split("#"),Ai;if(s.length>1){Ai=s[1];if(Ai.length>0&&y.find("#"+Ai).length>0){AB("#"+Ai,true);return false;}}});}function AO(){var Aj,Ai,Al,Ak,Am,s=false;AM.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(An){var Ao=An.originalEvent.touches[0];Aj=Ac();Ai=Aa();Al=Ao.pageX;Ak=Ao.pageY;Am=false;s=true;}).bind("touchmove.jsp",function(Aq){if(!s){return ;}var Ap=Aq.originalEvent.touches[0],Ao=AA,An=h;p.scrollTo(Aj+Al-Ap.pageX,Ai+Ak-Ap.pageY);Am=Am||Math.abs(Al-Ap.pageX)>5||Math.abs(Ak-Ap.pageY)>5;return Ao==AA&&An==h;}).bind("touchend.jsp",function(An){s=false;}).bind("click.jsp-touchclick",function(An){if(Am){Am=false;return false;}});}function G(){var s=Aa(),Ai=Ac();c.removeClass("jspScrollable").unbind(".jsp");c.replaceWith(AP.append(y.children()));AP.scrollTop(s);AP.scrollLeft(Ai);}B.extend(p,{reinitialise:function(Ai){Ai=B.extend({},AY,Ai);AS(Ai);},scrollToElement:function(Aj,Ai,s){AB(Aj,Ai,s);},scrollTo:function(Aj,s,Ai){m(Aj,Ai);l(s,Ai);},scrollToX:function(Ai,s){m(Ai,s);},scrollToY:function(s,Ai){l(s,Ai);},scrollToPercentX:function(Ai,s){m(Ai*(t-AK),s);},scrollToPercentY:function(Ai,s){l(Ai*(z-U),s);},scrollBy:function(Ai,s,Aj){p.scrollByX(Ai,Aj);p.scrollByY(s,Aj);},scrollByX:function(s,Aj){var Ai=Ac()+Math[s<0?"floor":"ceil"](s),Ak=Ai/(t-AK);w(Ak*J,Aj);},scrollByY:function(s,Aj){var Ai=Aa()+Math[s<0?"floor":"ceil"](s),Ak=Ai/(z-U);v(Ak*I,Aj);},positionDragX:function(s,Ai){w(s,Ai);},positionDragY:function(Ai,s){v(Ai,s);},animate:function(Ai,Al,s,Ak){var Aj={};Aj[Al]=s;Ai.animate(Aj,{duration:AY.animateDuration,easing:AY.animateEase,queue:false,step:Ak});},getContentPositionX:function(){return Ac();},getContentPositionY:function(){return Aa();},getContentWidth:function(){return t;},getContentHeight:function(){return z;},getPercentScrolledX:function(){return Ac()/(t-AK);},getPercentScrolledY:function(){return Aa()/(z-U);},getIsScrollableH:function(){return Ae;},getIsScrollableV:function(){return AZ;},getContentPane:function(){return y;},scrollToBottom:function(s){v(I,s);},hijackInternalLinks:function(){M();},destroy:function(){G();}});AS(n);}E=B.extend({},B.fn.jScrollPane.defaults,E);B.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){E[this]=E[this]||E.speed;});return this.each(function(){var F=B(this),G=F.data("jsp");if(G){G.reinitialise(E);}else{G=new D(F,E);F.data("jsp",G);}});};B.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,stickToBottom:false,stickToRight:false,clickOnTrack:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:C,animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:false,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:true,hideFocus:false,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:0.8};})(jQuery,this);