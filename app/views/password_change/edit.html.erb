<% content_for :title do %><% t('password_change.edit.reset') %><% end %>

<%= javascript_include_tag 'common', 'common_vendor', 'sessions' %>

<div class="CDB-Text <%= @organization.present? ? 'Sessions' : 'Sessions-navy' %>" style="<%= @organization.present? ? background : '' %>">
  <div class="Sessions-content">
    <div class="Sessions-inner">
      <div class="u-inner">
        <div class="Sessions-left">
          <div class="Sessions-logoContainer">
            <%= render :partial => 'shared/logo', locals: { organization: @organization } %>
          </div>

          <div class="Sessions-form">
            <%= form_for @user, url: CartoDB.path(self, 'password_change'), class: "js-Loading-form" do |f| %>
              <% if @password_error %>
                <p class="CDB-Text CDB-Size-huge u-altTextColor u-tSpace--m u-justifyCenter Sessions-description" style="background: #f24440; border-radius: 4px; padding: 5px; color: #fff;">
                  <%= raw @password_error %>
                </p>
              <% end %>

              <%= f.hidden_field :username %>
              <div class="Sessions-fieldsGorup">
                <div class="Sessions-field">
                  <%= password_field_tag :old_password, "", placeholder: t('password_change.edit.current'), class: "CDB-Size-medium #{@organization.present? ? 'Sessions-input' : 'Sessions-navy-input'} bottomBorderRadius" %>

                  <% if @old_password_error %>
                    <div class="Sessions-fieldError js-Sessions-fieldError" data-content="<%= @old_password_error %>">!</div>
                  <% end %>
                </div>

                <div class="Sessions-field">
                  <%= password_field_tag :password, "", placeholder: t('password_change.edit.new'), class: "CDB-Size-medium #{@organization.present? ? 'Sessions-input' : 'Sessions-navy-input'} bottomBorderRadius" %>

                  <% if @new_password_error %>
                    <div class="Sessions-fieldError js-Sessions-fieldError" data-content="<%= @new_password_error %>">!</div>
                  <% end %>
                </div>

                <div class="Sessions-field">
                  <%= password_field_tag :password_confirmation, "", placeholder: t('password_change.edit.retype'), class: "CDB-Size-medium #{@organization.present? ? 'Sessions-input' : 'Sessions-navy-input'} bottomBorderRadius" %>

                  <% if @new_password_error %>
                    <div class="Sessions-fieldError js-Sessions-fieldError" data-content="<%= @new_password_error %>">!</div>
                  <% end %>
                </div>

                <div class="Sessions-field">
                  <p>
                    <button type="submit" class="Sessions-submitButton u-tupper js-Sessions-button js-Loading">
                      <span class="js-Loading-text"><%= 'Save' %></span>
                      <%= render :partial => 'shared/loading_animation' %>
                    </button>
                  </p>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <% unless cartodb_com_hosted? %>
    <footer class="Sessions-footer">
      <div class="u-inner">
        <div class="Sessions-notloggedin is-active">
          <p class="Sessions-text Sessions-text--footer u-txt-center u-altTextColor"><% t('password_change.edit.noaccount') %><%= link_to 'Sign up here', "https://carto.com/signup" %></p>
        </div>
      </div>
    </footer>
  <% end %>
</div>
