<div class="Editor js-editor">
  <div id="dashboard"></div>
</div>

<%= insert_trackjs('builder') %>

<script>
  var frontendConfig = <%= safe_js_object frontend_config %>;
  var visualizationData = <%= safe_js_object @visualization_data.to_json %>;
  var layersData = <%= safe_js_object @layers_data.to_json %>;
  var vizJSON = <%= safe_js_object @vizjson.to_hash.to_json %>;
  var stateJSON = <%= safe_js_object @state.to_json %>;
  var userData = <%= safe_js_object current_user.data({ show_api_calls: false }).to_json %>;
  var analysesData = <%= safe_js_object @analyses_data.to_json %>;
  var basemaps = <%= safe_js_object @basemaps.to_json %>;
  var overlaysData = <%= safe_js_object @overlays_data.to_json %>;
  var mapcapsData = <%= safe_js_object @mapcaps_data.to_json %>;
  var builderNotifications = <%= safe_js_object @builder_notifications.to_json %>;
  var dashboardNotifications = <%= safe_js_object @dashboard_notifications.to_json %>;
  var ACTIVE_LOCALE = 'en';
  var geocoderConfiguration = <%= safe_js_object geocoder_config.to_json %>;
</script>

<% if @visualization.map.provider == 'googlemaps' %>
  <%= insert_google_maps(@visualization.user.google_maps_query_string) %>
<% end %>

<%= javascript_include_tag 'common.js' %>
<%= javascript_include_tag 'common_vendor.js' %>
<%= javascript_include_tag 'builder.js' %>

<%= insert_fullstory %>
